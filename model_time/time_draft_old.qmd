---
title: "The certain present needs vs. the uncertain future: why poverty increases time discounting"
format:
  pdf
    
    
editor: visual
bibliography: references.bib
header-includes:
  - \usepackage{tikz}
  - \usepackage{ebgaramond}
  - \usepackage{booktabs}
  - \usepackage{tabularx}
  - \addtokomafont{disposition}{\rmfamily}
---

## Introduction

In situations of poverty, humans are often observed to heavily discount the future [@reimers2009; @green1996; @haushofer2014; @lawrance1991; Carvalho 2010]. This manifests in consequential ways: for instance, low-income individuals often take short term loans with prohibitive interest rates [@banerjee2007 OTHER REF]. The association has been observed repeatedly since Malthus REF, and causality has been found to be bidirectional \[REF Doepke\]: not only do short-term oriented individuals accumulate less wealth \[REF Dohmen; EpperAER\], but having low resources also increases time discounting \[REF Carvalho; Handa; Haushofer2019\] -- the process we are here interested in. In a recent review, time discounting has actually been found to be the only causally robust effect of poverty on decision making [@haushofer]. This effect is of interest to several disciplines, including economics [@lawrance1991], sociology [@duvoux2023], psychology [@haushofer2014; @griskevicius2013] and criminology \[REF VG&Frak\]. It has profound implications: it has been proposed (i) as the cause of the 'behavioural constellation of poverty', the ensemble of behavioral specificities accross domains that are commonly found among individuals in situations of poverty [@pepper2017], (ii) as a possible reason for poverty persistence [@haushofer2014], and (iii) as a reason for the higher prevalence of crime - a behaviour that often brings short-term benefits and potential long-term legal troubles - in deprived populations [@pepper2017; @brezina2008].

Yet, in stark contrast with the settled empirical case, it remains unclear why poverty increases time discounting. Two perspectives have been proposed. The first considers high discounting as a symptom that poverty degrades decision making. This can occur through stress [REF Haushofer], ego-depletion [REF Spears] or, most famously, a 'tunneling effect': as REF Shah put it, "While focusing on the groceries from week to week, we might neglect next month's rent" (p. XXX). In a similar vein, @banerjee2007 suggest that not thinking about the future is "emotionally wise [...], to avoid confronting the sheer inadequacy of the standard of living" (p. 165).

A second perspective, which we adopt here, proposes that high discounting is not dysfunctional, but on the contrary an appropriate response to a context of poverty. A common justification is "collection risks": in poverty, people may be less likely to actually collect the future reward, for instance because of a higher mortality risk \[REF Griskevicius\]. However, this explanation fails to account for the influence of 'states', like hunger or more generally financial need \[REF Sharma; Carvalho; Fitzpatrick & Coleman-jensen\], on time discounting: collection risks are an environment-level parameter, quite stable on short term scales. Furthermore, collection risks are only one side of the problem: poverty also increases how much one needs resources, and can thereby create 'opportunity costs' \[REF Mell\]. Several authors \[sharma, haushofer2019, Mell, frankenhuis2020, fisher\] propose a simple verbal justification, well put by the character Earn in the TV series *Atlanta*: "poor people don't have time for investments, because poor people are too busy trying not to be poor! I need to eat today, not in September...".

However intuitive Earn's argument might be, we consider it to be underspecified, and potentially misleading. Indeed, the optimal level of time discounting depends not only on the value of present consumption, but also on the (expected) value of future consumption -- which should also increase in situations of poverty, if there is any resource autocorrelation. Simply put, Earn will also need to eat in September -- his current level of need is therefore not a sufficient reason to discount the future. The reasoning only holds if survival is at stake [@chavas2013] or if Earn has reasons to expect his situation to improve in the meantime -- that is, if his poverty is not a persistent condition, but a rough patch. In fact, we are aware of two attempts to formalize this intuition in economics and evolutionary psychology \[REF Epper; REF Mell\]. Both rely on the assumption that individuals in situations of poverty expect their situation to improve. If someone expects to be even worse off in the future, these models instead predict patience \[Epper, p. 4\]. This hardly applies to the "truly disadvantaged" populations \[REF Wilson\], who tend to be stuck in poverty, and are often found by ethnographers to be rather pessimistic \[McLeod 1985; Wilson; Lewis?\]. Among them, offenders have been described in ethnographies as both extremely short-term oriented and particularly pessimistic about the future \[Wilson; Dickinson & Topalli; Anderson\]. Thus, we consider that the literature lacks a model able to explain why humans tend to discount the future when they struggle to meet basic needs, and their future is not brighter.

In this paper, we show that Earn's argument is warranted under an alternative conceptualisation of needs', grounded in the desperation threshold model (DTM, REF). The DTM posits that individuals experience a critical resource level representing basic needs above which they strongly prefer to be. In contrast with the standard microeconomics model, the DTM does not assume a concave mapping between resources and utlity, but a S-shape. The utility function possess a very steep region -- the desperation threshold --, where basic needs hang in the balance. It is flatter both above and below the threshold, as basic needs are respectively securely satisfied and definitively unmet. Here, we extend the DTM from the study of risk taking to the study of intertemporal decisions, introducing four distinct implementations. We demonstrate that, regardless of implementation, one should discount the future more when close to this threshold. This occurs because the long term is more uncertain than the present: individuals situation may improve or worsen, both resulting in lower subjective resource valuation. For the same reason, the models predicts even more pronounced discounting when a desperate individual has *directional* expectations about the future: whether she expects to have more or less resources in the future, future rewards become further devalued. Thus, unlike previous approaches REF, our result is not contingent on assuming that individuals in poverty are optimistic about the future, and yet it integrates those models highlighting optimism's role with empirical evidence of extreme discounting among populations experiencing both acute need and fatalistic beliefs \[REF\].

## Model
We model an agent living for two periods (Fig. 1A). She is defined by a single state parameter: its level of resources, that changes stochastically over time. The agent begins with $x_0$ resources -- a fixed parameter that can be interpreted as the inverse of his poverty level. The resource level is subject to random shocks before the first time period, and between the first and the second. These shocks are independent and identically distributed, following a normal distribution with mean zero and variance $\sigma^2$, where $\sigma$ represents environmental volatility. Between periods, a constant drift parameter $d$ is applied to the resource level. This parameter captures future expectations: $\mathbb{E}(x_2|x_1)= x_1 + d$, in other words one expects his state to improve over time if $d>0$, and to degrade if $d<0$. For simplicity, we do not distinguish between consumption and capital: the variables $x_i$ summarises the material standing of the individual at time $i$. This could be interpreted, for example, as an animal's energy reserves.

The agent's preferences are represented by a utility function that depends on resource states in both periods, $x_1$ and $x_2$. Here, we found that translating the desperation threshold concept into an intertemporal utility function is a delicate problem. The threshold is verbally defined as a strong disutility below some level of resources \[REF BBS\]. Yet, it has been formalised in several, slightly different ways: as a fixed utility cost with a lower bound \[REF 2021\] or as a relative cost (a percentage of the final utility) \[REF 2023\] in an infinite time period model, or as a sigmoidal utility function in a synchronic framework \[REF\]. While these implementations yield qualitatively similar predictions regarding risk-taking -- the primary dependent variable in previous studies -- their implications on time discounting differ substantially. For the sake of exhaustiveness, we present the four plausible implementations, highlighting their divergences. We keep these functions as simple as possible, combining a linear dependence on states with thresholds effects. In other words, we neglect diminishing marginal utility at high resource levels, since our analysis focuses on decision making around the threshold.

In Fig. 1, we define and visualize the four utility functions in heatmaps, along with their intuitive names. In the first one, falling below the threshold incurs a fixed utility penalty $w$. This penalty applies additively: being below the threshold in both periods generates twice the disutility of being below once. This function can represent non-crucial desires: for instance, being unable to afford going to a concert. Importantly, utility continues to decrease linearly below the threshold without a lower bound, meaning that one is still sensitive to its level of resources even if can not meet the goal. The second function sets period utility to zero whenever resources fall below the threshold. Here and in the next functions, an agent becomes indifferent to its state when below the threshold. To create a discontinuous utility jump at the threshold, we introduce a constant $w$ in this and subsequent functions. This function can represent 'hibernation': being below the threshold makes it impossible to accumulate utility in the present, but preserves the possibility to do so in the future. The third function represents a 'game-over' below the threshold: it cancels not only the utility of this time period, but also of possible future time periods. This captures irreversible consequences like eviction: even if resources become sufficient tomorrow, today's eviction cannot be undone. Our fourth function sets lifetime utility to zero if resources fall below the threshold in any period. Even if one has been above the threshold in the past, it has all been 'in vain'. This can for instance capture starvation during development: life termminates, and the previously accumulated physical capital is inconsequential.

These utility functions give rise to a time orientation, i.e. a preference for sooner, or later, resources. We capture the agent's 'impatience' through its marginal rate of intertemporal substitution (MRIS) -- the amount one must receive to willingly surrender €1 today. Formally, $$
MRIS(x_0) = \frac{\frac{d\mathbb{E}(U)}{dx_1}}{\frac{d\mathbb{E}(U)}{dx_2}}
$$

In other words, the agent decides on his degree of impatience based on its initial level of resources, by comparing to what extent an extra resource in the first time period makes her happier than an extra resource in the second one. Note that when computing the marginal utility in the first period, we assume that the extra resource is absent in the second period. This is simply a way to present the results in a more insightful way. Otherwise, $MRIS > 1$ by construction: one always prefers to have the resource in the short term, even is it is mainly useful in the long term. Note also that $x_1$ and $x_2$ are random variables. $MRIS$ thus depends on *expected* marginal utilities knowing only $x_0$. By differentiating with respect to $x_1$, we mean with respect to its expectation, while keeping $\mathbb{E}(x_2)$ constant. This specification is necessary to obtain a meaningful discount factor: as we study discontinuous -- and therefore non-differentiable -- utility functions, the random perturbations smoothes utility, ensuring marginal utility is well-defined.

```{r}
#| fig.cap: "Summary of the model assumptions. "
#| out.width: "80%"  # Control the size as needed
#| echo: false

knitr::include_graphics("figure.svg")

```

Fig 1, categorical diff at zero + highlight + get rid of discount factor

## Results

```{python}
#| echo: false
#| fig.cap: "Impatience depending on the initial level of resources $x_0$. Here, we assume neutral future expectations ($d=0$), and $\\sigma = 1$. In the SI, we present heatmaps for any values of $d$ and $x_0$ and sensitivity analysis for the effect of $\\sigma$."


import numpy as np
from scipy import stats
import matplotlib.pyplot as plt
from matplotlib import rc
from matplotlib import rcParams

rc('text', usetex=True)
rcParams['font.family'] = 'garamond'

def beta_oneoff(x_0,d=0,w=5,σ=1):
    marginal_1 =stats.norm.cdf(x_0,scale = σ) + w*stats.norm.pdf(x_0,scale = σ )
    marginal_2 = stats.norm.cdf((x_0+d)/np.sqrt(2),scale = σ)  + w*stats.norm.pdf(
        (x_0+d)/np.sqrt(2),scale = σ)/np.sqrt(2)
    return marginal_1/marginal_2

def beta_cliff(x_0,d=0,w=5,σ=1):
    marginal_1 = 1 + w*stats.norm.pdf(x_0,scale = σ )
    marginal_2 = 1 + w*stats.norm.pdf(
        (x_0+d)/np.sqrt(2),scale = σ)/np.sqrt(2)
    return marginal_1/marginal_2

def beta_gameover(x_0,d,w=5,σ=1):
    def prob_both_above(x_0):
        mean = [x_0,x_0+d]
        cov = np.array([[σ**2, σ**2],
                    [σ**2, 2*σ**2]])
        return 1 - stats.norm.cdf(-x_0/σ) - stats.norm.cdf(-(x_0+d)/(σ*np.sqrt(2))) + stats.multivariate_normal.cdf([0, 0], mean=mean, cov=cov)
    marginal_1 = stats.norm.cdf(x_0) + w*stats.norm.pdf(x_0,scale=σ) +  stats.norm.pdf(x_0 + d, scale=σ) * ((w + d) * stats.norm.cdf(d, scale=σ) + σ**2 * stats.norm.pdf(x_0 + d, scale=σ))
    marginal_2 = prob_both_above(x_0) + w*stats.norm.pdf(x_0 + d, scale=np.sqrt(2) * σ) / np.sqrt(2) * stats.norm.cdf(x_0 - d, scale=np.sqrt(2) * σ)
    return marginal_1/marginal_2

def beta_onestrike(x_0,d=0,w=5,σ=1):
    def prob_both_above(x_0,σ,d):
        mean = [x_0,x_0+d]
        cov = np.array([[σ**2, σ**2],
                    [σ**2, 2*σ**2]])
        return 1 - stats.norm.cdf(-x_0/σ) - stats.norm.cdf(-(x_0+d)/(σ*np.sqrt(2))) + stats.multivariate_normal.cdf([0, 0], mean=mean, cov=cov)
    marginal_1 = prob_both_above(x_0,σ,d) + stats.norm.pdf(x_0, scale=σ) * ((w + d) * stats.norm.cdf(d, scale=σ) + σ**2 * stats.norm.pdf(x_0 + d, scale=σ))
    marginal_2 = prob_both_above(x_0,σ,d) + w*stats.norm.pdf(x_0 + d, scale=np.sqrt(2) * σ) / np.sqrt(2) * stats.norm.cdf(x_0 - d, scale=np.sqrt(2) * σ)
    return marginal_1/marginal_2

fig, axes = plt.subplots(2, 2, figsize=(8, 8))  # Adjust figsize as needed
X = np.linspace(-5,5,200)
w = 5
d = 0
σ = 1
axes[0, 0].plot(X,[beta_cliff(x_0,σ=σ,w=w,d=d) for x_0 in X], color="k")
axes[0, 1].plot(X,[beta_oneoff(x_0,σ=σ,w=w,d=d) for x_0 in X], color="k")
axes[1, 0].plot(X,[beta_gameover(x_0,σ=σ,w=w,d=d) for x_0 in X], color="k")
axes[1, 1].plot(X,[beta_onestrike(x_0,σ=σ,w=w,d=d) for x_0 in X], color="k")

axes[0, 0].set_title(r"\textbf{Fixed cost}")
axes[0, 1].set_title(r"\textbf{Full cost, one time}")
axes[1, 0].set_title(r"\textbf{Full cost, future times}")
axes[1, 1].set_title(r"\textbf{Full cost, all times")

#axes[0, 0].set_xlabel("Resources",fontsize=12)
#axes[0, 0].set_ylabel("Discount rate",fontsize=12)

for ax in axes.flat:
    ax.set_yscale("log")
    ax.axhline(y=1, color='k', linestyle='--', linewidth=1)  # Ligne horizontale pour y=1
    ax.axvline(x=0, color='k', linestyle='--', linewidth=1)  # Ligne verticale pour x=0
    #ax.grid(True, which="both", linestyle="--", alpha=0.6)

fig.text(0.53, 0.0, "Resources", ha='center', va='center', fontsize=20, fontweight='bold')

# Add a big y label in the middle (to the left of the subplots)
fig.text(0.04, 0.5, "Impatience", ha='center', va='center', rotation='vertical', fontsize=20, fontweight='bold')

plt.tight_layout()
```
We analyse our model by describing how time discounting, as measured by the MRIS, varies depending on the agent's state $x_0$, future expectations $d$ and environment volatility $\sigma$. Here, we give an intuitive account of the results, and develop some mathematical details of only the simpler cases -- the 'additive penalty' and the 'hibernation' scenario, that are time-separable. The two other scenarios, detailed analytical proofs, asymptotic approximations and full numerical results can be found in the SI. 

An extra resource has two effects on the agent's utility. First, a 'level effect': it makes her richer on average. This increases utility for sure in the 'additive penalty' case, and if the threshold conditions are met in the other cases. The marginal effect is thus respectively 1 and $P(x_1>0)=\Phi_{\sigma^2}(x_0)$, with $\Phi$ the normal cumulative distribution function of mean 0 and variance $\sigma^2$. Second, the extra resource a 'threshold effect': a resource may help to be above the threshold, which brings a utility of $w$ with a weight $\phi(x_0)$ -- the normal probability density function. This component follows the bell-shaped Gaussian curve, with a peak at $x_0=0$. This captures the DTM intuition: one never needs resources more than when he is on the threshold of desperation. Due to Leibniz integration rule, marginal utilities are the sum of those two terms, which mathematically correspond respectively to the derivative under the integral and the boundary term. The marginal utility in the second period has the same functional form, only with a doubled variance and a translation $d$. In the additive penalty case, this yields: 
$$MRIS = \frac{1+w\phi_{\sigma^2}(x_0)}{\underbrace{1}_{\text{level effect}}+\underbrace{w\phi_{2\sigma^2}(x_0+d)}_{\text{threshold effect}}}$$. 


In Fig. 2, we display impatience levels depending on $x_0$, under neutral future expectations ($d=0$). Above and around the threshold, all four scenarios converge qualitatively. Far above the threshold, the agent is neither patient nor impatient ($MRIS \sim 1$): as the threshold is of no concern ($\phi(x_0) = o(1)$), a resource tomorrow has, by assumption, the same value as a resource today. When only slightly above the threshold, the agent prefers prefers to obtain resources later, out of 'precaution': she is safe in the short term, but not the longer term. It reverses when very close to the threshold. In this region, meeting the threshold hangs in the balance both in the short and the long term, but the long term is more uncertain. One can thus be quite sure to need the resources in the short term, but in the long term, her situation is likely to have changed in the meantime. Whether it has improved or worsened, the resource is less valuable, as the threshold is out of reach. Fig. 3 illustrates both these results by comparing the chance that a resource has a higher change to tip one above the threshold in the short term and in the long term. From this point of view, one should favor the present when too close to the threshold and the future otherwise: for $x_0 > 0$, $\phi_{2\sigma^2}(x_0) > \phi_{\sigma^2}(x_0)  \Longleftrightarrow x_0 < \sigma \sqrt{2\ln 2}$. This gives the exact region where the agent favours the present in the additive penalty scenario ($MRIS > 1 \Longleftrightarrow x < \sigma \sqrt{2\ln 2}$), and a sufficient condition for it in the three other scenarios. The width of this impatience region is proportional to the volatility $\sigma$: the more uncertain the future, the richer one has to be in order to be safe in the short term. That said, volatility has no overall effect on time discounting, it rather acts like a scaling parameter: for the same reason, increasing volatility also widens the zone where the agent is patient out of 'precaution' (Fig. SXX). 

Under the desperation threshold, the different scenarios paint starkly different pictures. The 'additive penalty' scenario predicts a symmetric pattern - due to the symmetry of the utility function. When the threshold is out of reach, it is of no concern, and the agent simply maximises the sum of its states. In the 'hibernation' scenario, the agent becomes develops an extreme infinite for future rewards as its resource levels sinks. In this case, since the long term is more uncertain, one has a better shot at ending up above the threshold in the second time period than the first ($\phi_{\sigma^2}(x_0) = o(\phi_{\sigma^2}(x_0))$). The best strategy is therefore to accept to be below the threshold in the short term -- hence the 'hibernation' name. This strategy is impossible in the two other scenarios -- the game is over if $x_1 < 0$. This leads to extreme time discounting below the threshold: one needs to eat today in order for there to be a tomorrow. 

In all cases except the 'all in vain' scenario, $d$ has an effect that we did not anticipate: a U-shaped effect on time discounting (in Fig. 4, we plot the MRIS depending on $d$, for $x_0=0$). The right-hand side is not a new result: if you expect to be flush tomorrow, you should satisfy your present needs. The left-hand side, though, is a new result, and depends on the desperation threshold assumptions: if the threshold is reachable today, but you strongly expect to be below the threshold, then one should focus on the present. The effect is especially pronounced in the 'hibernation' and the 'game-over' scenario, where one gets no utility when below the threshold. Intuitvely, in these two cases, the agent prefers to enjoy today, as she knows that tomorrow will be equally awful whatever she does. This strategy is impossible in the 'all in vain' scenario -- if below the threshold in the long term, then the short term is also ruined -- hence the monotonous effect of $d$.

The U-shape of Fig. 4 is valid in any case, but the inflection point depends on $x_0$. For high $w$ -- that is, if the threshold has a massive utility impact, the MRIS (REF equation above) is approximately $\sqrt{2}exp(\frac{−x_0^2+2x_0d+d^2}{4\sigma^2})$. Differentiating with respect to $d$ within the exponential, the MRIS reaches a minimum at $d=-x_0$, that is, when you expect to be right at the desperation threshold in period 2. Intuitively, this means that the should be maximally patient when she expects her basic needs to be in the balance tomorrow.






 
```{python}
#| echo: false
#| fig.cap: "Chance to hit the threshold in the short term and the long term, when $d=0$."


X = np.linspace(-5, 5, 1000)
y1 = [stats.norm.cdf(x_0,scale = 1) + w*stats.norm.pdf(x_0,scale = 1) for x_0 in X]
y2 = [stats.norm.cdf(x_0,scale = 2) + w*stats.norm.pdf(x_0,scale = 2) for x_0 in X]

# Create the plot
plt.figure(figsize=(10, 6))
plt.plot(X, y1, 'k-', linewidth=2, label='Short-term marginal utility')
plt.plot(X, y2, 'k--', linewidth=2, label='Long-term marginal utility')
line_pos = np.sqrt(2 * np.log(2))  # Positive position
line_neg = -line_pos
plt.axvline(x=line_pos, color='gray', linestyle=':', linewidth=1.5)
plt.axvline(x=line_neg, color='gray', linestyle=':', linewidth=1.5)
# Annotate the vertical lines
plt.text(line_pos + 0.1, 0.25, r'$+\sqrt{2\ln(2)}$', fontsize=10)
plt.text(line_neg - 0.8, 0.25, r'$-\sqrt{2\ln(2)}$', fontsize=10)

# Add labels and legend
plt.xlabel('$x_0$')
plt.ylabel('Probability Density')
plt.legend()
plt.show()


```


In the supplements, we present the effect of unpredictability ($\sigma$). It enlarges the 'impatience' region (analytical result for the additive penalty scenario, $\beta > 1 \Longleftrightarrow\quad |x| < \sigma \sqrt{2\ln 2}$

## Discussion

-   We have shown that the verbal argument is underspecified. What do we really mean by need? It's a folk psychological concept. We define it as a particularly steep utility region, steeper than above *and below*.

-   Rediscuss scarcity theory? Bartos paper finds that the difference is not driven by inattention.

-   We bring three different reasons to discount the future when on the edge

-   Show that the 3 mechanisms are specific to the threshold. You don't get any of those results if the utility is linear. Try with concave utility?

-   Maybe elites are not so future oriented? (Doepke, leisure)

-   To what extent does our results explain the social gradient?

-   More precisely, we predict extreme discounting in situations of acute need. Is that realistic? Payday loans, yesuf2008. Probably not delay gratification or health.

-   echoes of results in @sharma2023, other paper about optimism, and Elijah Anderson + Shu et al. (non-fatalistic beliefs)

-   our model has very modest assumption, $\sigma$ plays the role of smoothing and of uncertainty

-   We neglect a lot of factors, we do not study time inconsistency, even though 'commitment' evidence suggest that it's part of the story (Bernheim 2015 solves our counter-argument by assuming present-bias)
